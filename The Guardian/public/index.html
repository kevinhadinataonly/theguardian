<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <meta http-equiv="X-UA-Compatible" content="">
        <title>The Guardian</title>
        <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

        <!-- Custom fonts for this template -->
        <link href="vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
        <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
        <link href='https://fonts.googleapis.com/css?family=Merriweather:400,300,300italic,400italic,700,700italic,900,900italic' rel='stylesheet' type='text/css'>

        <!-- Plugin CSS -->
        <link href="vendor/magnific-popup/magnific-popup.css" rel="stylesheet">

        <!-- Custom styles for this template -->
        <link href="css/creative.min.css" rel="stylesheet">
    </head>

    <body id="page-top">
        <nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
            <div class="container">
                <a class="navbar-brand js-scroll-trigger" href="#page-top">The Guardian</a>
                <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarResponsive">
                    <ul class="navbar-nav ml-auto">
                        <li class="nav-item">
                            <a class="nav-link js-scroll-trigger" href="#about">About</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link js-scroll-trigger" href="#services">Services</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link js-scroll-trigger" href="#portfolio">Portfolio</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
        
        <section class="bg-primary" id="about">
            <div class="container">
                <div class="row">
                    <div class="col-lg-8 mx-auto text-center">
                        <h2 class="section-heading text-white">We've got what you need!</h2>
                        <hr class="light my-4">
                        <p class="text-faded mb-4">Start a day with news</p>
                        <a class="btn btn-light btn-xl js-scroll-trigger" href="#services">Get Started!</a>
                    </div>
                </div>
            </div>
        </section>

        <section id="services">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12 text-center">
                        <h1 class="section-header">Welcome!</h1>
                        <hr class="my-4">
                    </div>
                </div>
            </div>

            <div class="container" style="margin-top: 30px">
                <div class="form-group" style="margin-top: 100px">
                    <label for="tags">Tags</label>
                    <select class="form-control" id="tags" aria-describedby="tagsHelp"></select>
                    <small id="tagsHelp" class="form-text text-muted">Choose your Tags</small>
                </div>
                <div class="form-group">
                    <label for="orderBy">Order By</label>
                        <select class="form-control" id="orderBy" aria-describedby="orderByHelp">
                        <option value="newest" selected>newest</option>
                        <option value="oldest">oldest</option>
                        <option value="relevance">relevance</option>
                    </select>
                    <small id="orderByHelp" class="form-text text-muted">Choose your orderBy</small>
                </div>
                <div class="form-group">
                    <label for="content">Content</label>
                    <input type="text" class="form-control" id="content" aria-describedby="contentHelp" placeholder="This field can be empty"/>
                    <small id="contentHelp" class="form-text text-muted">Enter your content (e.g. football)</small>
                </div>
                <a href="#dictionaryResult" class="nav-link js-scroll-trigger">
                    <button class="btn btn-block btn-xl btn-primary" id="search">Search</button>
                </a>
                <br>
                <br>
                <div class="row" id="dictionaryResult">
                        
                </div>
                <br>
                <br>
                <div class="row" id="result">
                        
                </div>
            </div>
        </section>

        <section id="portfolio">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12 text-center">
                        <h2 class="section-heading">For more information, please check this 2 links below:</h2>
                        <hr class="my-4">
                    </div>
                    <div class="col-md-12 col-lg-6 text-center">
                        <div class="service-box mt-5 mx-auto">
                            <img class="fa fa-4x" src="theguardianlog.png" alt="The Guardian's Logo" style="width: 300px; height: 50px">
                            <br>
                            <br>
                            <p class="mb-0">
                                <a href="https://www.theguardian.com/international">The Guardian US</a>
                            </p>
                        </div>
                    </div>
                    <div class="<col-md-12></col-md-12> col-lg-6 text-center">
                        <div class="service-box mt-5 mx-auto">
                            <img class="fa fa-4x" src="oxford dictionary.png" alt="Oxford Dictionary's Logo" style="width: 50px; height: 50px">
                            <br>
                            <br>
                            <p class="mb-0">
                                <a href="https://en.oxforddictionaries.com/">Oxford Dictionary</a>
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <footer class="py-5 bg-dark">
            <div class="container">
                <p class="m-0 text-center text-white">
                    Copyright &copy; Kwik Kian Gie Student
                    Kevin Hadinata
                    Jonathan
                    Asyer
                </p>
            </div>
        </footer>

        <script src="vendor/jquery/jquery.min.js"></script>
        <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

        <!-- Plugin JavaScript -->
        <script src="vendor/jquery-easing/jquery.easing.min.js"></script>
        <script src="vendor/scrollreveal/scrollreveal.min.js"></script>
        <script src="vendor/magnific-popup/jquery.magnific-popup.min.js"></script>

        <!-- Custom scripts for this template -->
        <script src="js/creative.min.js"></script>

        <script id="hidden-template" type="text/x-custom-template">
            <div class="col-sm-12 col-md-6 col-lg-4 mb-4">
                 <div class="card h-75">
                    <a href="#" target="_blank" class="btn-view">
                        <img class="card-img-top" src="" alt="New's image">
                    </a>
                    <div class="card-body">
                        <h5 class="card-title"></h5>
                    </div>
                    <div class="card-footer">
                        <p class="text-muted card-text"></p>
                    </div>
                </div>
            </div>
        </script>

        <script id="hidden-template-dictionary" type="text/x-custom-template">
            <div class="col-sm-12">
                <div class="card-header">
                    Definition
                </div>
                <div class="card-body">
                    <h4 class="card-word"> :                       
                        <h5 class="card-meaning"></h5>
                    </h4>
                </div>
            </div>
        </script>

        <script>
            var apiKey = '84a62d4e-d5aa-47ff-8e60-979b89416dca';
            var baseUrl = 'https://content.guardianapis.com';
            
            $(document).ready(function() {
                function getTag() {
                    var url = baseUrl + '/sections?api-key=' + apiKey;
                    
                    $.ajax({
                        url: url
                    }).then(function (data) {
                        console.log(data);
                        for (var i = 0; i < data.response.total; i++) {
                            var element = data.response.results[i];
                            $("#tags").append(new Option(element.id));
                        }
                    });
                }

                $("#search").click(function() {
                    var contentSearch = $("#content").val();
                    var tagSearch = $("#tags").val();

                    if(contentSearch === "") {
                        var q = jQuery.param({
                            'order-by': $("#orderBy").val(),
                            format: 'json',
                            'show-fields': 'thumbnail',
                            'api-key': apiKey
                        });

                        var url = baseUrl + '/search?page-size=100&tag=' + tagSearch + '/' + tagSearch + '&' + q;
                    } else {
                        var q = jQuery.param({
                            q: contentSearch,
                            'order-by': $("#orderBy").val(),
                            format: 'json',
                            'show-fields': 'thumbnail',
                            'api-key': apiKey
                        });

                        var url = baseUrl + '/search?tag=' + tagSearch + '/' + tagSearch + '&' + q;
                    }

                    console.log(url);

                    $.ajax({
                        url: url
                    }).then(function (data) {
                        console.log(data);

                        $("#result").empty();

                        if (data) {
                            for (var i = 0; i < data.response.results.length; i++) {

                                var result = data.response.results[i];
                                var template = $('#hidden-template').html();

                                var item = $(template).clone();

                                $(item).find('.card-img-top').attr('src',result.fields.thumbnail);
                                $(item).find('.card-title').html(result.webTitle);
                                $(item).find('.card-text').html('Section: ' + result.pillarName);
                                $(item).find('.btn-view').attr('href', result.webUrl);
                                $("#result").append(item);
                            }
                        }
                    });

                    getDictionary();
                });

                function getDictionary() {
                    var baseUrl = 'https://od-api.oxforddictionaries.com/api/v1';
                    var proxyUrl = 'https://cors-anywhere.herokuapp.com/';
                    var idSearch = $("#tags").val();
                    var word_id = jQuery.param({
                        word_id: idSearch
                    });
                
                    var url = proxyUrl + baseUrl + '/entries/en/' + idSearch;

                    console.log(url);

                    $.ajax({
                        url: url,
                        headers: {
                            "app_key": "d613a833727926ca200112caca549297",
                            "app_id": "b3cbf30d"
                        }
                    }).then(function (data) {
                        $("#dictionaryResult").empty();

                        if(data) {
                            var template = $('#hidden-template-dictionary').html();
                            var item = $(template).clone();
                            $(item).find('.card-word').html(data.results[0].id);
                            $(item).find('.card-meaning').html(data.results[0].lexicalEntries[0].entries[0].senses[0].definitions[0]);
                    
                            $("#dictionaryResult").html(item);
                        }
                    });
                }
                getTag();
            });
        </script>
    </body>
</html>